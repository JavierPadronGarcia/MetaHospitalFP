{"version":3,"file":"image.js","names":["colCache","require","Anchor","Image","worksheet","model","type","imageId","hyperlinks","range","tl","br","ext","Error","decoded","decode","col","left","row","top","right","bottom","editAs","module","exports"],"sources":["../../../lib/doc/image.js"],"sourcesContent":["const colCache = require('../utils/col-cache');\nconst Anchor = require('./anchor');\n\nclass Image {\n  constructor(worksheet, model) {\n    this.worksheet = worksheet;\n    this.model = model;\n  }\n\n  get model() {\n    switch (this.type) {\n      case 'background':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n        };\n      case 'image':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n          hyperlinks: this.range.hyperlinks,\n          range: {\n            tl: this.range.tl.model,\n            br: this.range.br && this.range.br.model,\n            ext: this.range.ext,\n          },\n        };\n      default:\n        throw new Error('Invalid Image Type');\n    }\n  }\n\n  set model({type, imageId, range, hyperlinks}) {\n    this.type = type;\n    this.imageId = imageId;\n\n    if (type === 'image') {\n      if (typeof range === 'string') {\n        const decoded = colCache.decode(range);\n        this.range = {\n          tl: new Anchor(this.worksheet, {col: decoded.left, row: decoded.top}, -1),\n          br: new Anchor(this.worksheet, {col: decoded.right, row: decoded.bottom}, 0),\n          editAs: 'oneCell',\n        };\n      } else {\n        this.range = {\n          tl: new Anchor(this.worksheet, range.tl, 0),\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\n          ext: range.ext,\n          editAs: range.editAs,\n          hyperlinks: hyperlinks || range.hyperlinks,\n        };\n      }\n    }\n  }\n}\n\nmodule.exports = Image;"],"mappings":";;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,UAAD,CAAtB;;IAEME,K;EACJ,eAAYC,SAAZ,EAAuBC,KAAvB,EAA8B;IAAA;;IAC5B,KAAKD,SAAL,GAAiBA,SAAjB;IACA,KAAKC,KAAL,GAAaA,KAAb;EACD;;;;SAED,eAAY;MACV,QAAQ,KAAKC,IAAb;QACE,KAAK,YAAL;UACE,OAAO;YACLA,IAAI,EAAE,KAAKA,IADN;YAELC,OAAO,EAAE,KAAKA;UAFT,CAAP;;QAIF,KAAK,OAAL;UACE,OAAO;YACLD,IAAI,EAAE,KAAKA,IADN;YAELC,OAAO,EAAE,KAAKA,OAFT;YAGLC,UAAU,EAAE,KAAKC,KAAL,CAAWD,UAHlB;YAILC,KAAK,EAAE;cACLC,EAAE,EAAE,KAAKD,KAAL,CAAWC,EAAX,CAAcL,KADb;cAELM,EAAE,EAAE,KAAKF,KAAL,CAAWE,EAAX,IAAiB,KAAKF,KAAL,CAAWE,EAAX,CAAcN,KAF9B;cAGLO,GAAG,EAAE,KAAKH,KAAL,CAAWG;YAHX;UAJF,CAAP;;QAUF;UACE,MAAM,IAAIC,KAAJ,CAAU,oBAAV,CAAN;MAlBJ;IAoBD,C;SAED,mBAA8C;MAAA,IAAnCP,IAAmC,QAAnCA,IAAmC;MAAA,IAA7BC,OAA6B,QAA7BA,OAA6B;MAAA,IAApBE,KAAoB,QAApBA,KAAoB;MAAA,IAAbD,UAAa,QAAbA,UAAa;MAC5C,KAAKF,IAAL,GAAYA,IAAZ;MACA,KAAKC,OAAL,GAAeA,OAAf;;MAEA,IAAID,IAAI,KAAK,OAAb,EAAsB;QACpB,IAAI,OAAOG,KAAP,KAAiB,QAArB,EAA+B;UAC7B,IAAMK,OAAO,GAAGd,QAAQ,CAACe,MAAT,CAAgBN,KAAhB,CAAhB;UACA,KAAKA,KAAL,GAAa;YACXC,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKE,SAAhB,EAA2B;cAACY,GAAG,EAAEF,OAAO,CAACG,IAAd;cAAoBC,GAAG,EAAEJ,OAAO,CAACK;YAAjC,CAA3B,EAAkE,CAAC,CAAnE,CADO;YAEXR,EAAE,EAAE,IAAIT,MAAJ,CAAW,KAAKE,SAAhB,EAA2B;cAACY,GAAG,EAAEF,OAAO,CAACM,KAAd;cAAqBF,GAAG,EAAEJ,OAAO,CAACO;YAAlC,CAA3B,EAAsE,CAAtE,CAFO;YAGXC,MAAM,EAAE;UAHG,CAAb;QAKD,CAPD,MAOO;UACL,KAAKb,KAAL,GAAa;YACXC,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKE,SAAhB,EAA2BK,KAAK,CAACC,EAAjC,EAAqC,CAArC,CADO;YAEXC,EAAE,EAAEF,KAAK,CAACE,EAAN,IAAY,IAAIT,MAAJ,CAAW,KAAKE,SAAhB,EAA2BK,KAAK,CAACE,EAAjC,EAAqC,CAArC,CAFL;YAGXC,GAAG,EAAEH,KAAK,CAACG,GAHA;YAIXU,MAAM,EAAEb,KAAK,CAACa,MAJH;YAKXd,UAAU,EAAEA,UAAU,IAAIC,KAAK,CAACD;UALrB,CAAb;QAOD;MACF;IACF;;;;;;AAGHe,MAAM,CAACC,OAAP,GAAiBrB,KAAjB"}