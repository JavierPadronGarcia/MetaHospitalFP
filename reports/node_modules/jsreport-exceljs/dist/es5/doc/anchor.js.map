{"version":3,"file":"anchor.js","names":["colCache","require","Anchor","worksheet","address","offset","nativeCol","nativeColOff","nativeRow","nativeRowOff","decoded","decodeAddress","col","row","undefined","Math","min","colWidth","v","floor","rowHeight","getColumn","isCustomWidth","width","getRow","height","value","model","module","exports"],"sources":["../../../lib/doc/anchor.js"],"sourcesContent":["'use strict';\n\nconst colCache = require('../utils/col-cache');\n\nclass Anchor {\n  constructor(worksheet, address, offset = 0) {\n    if (!address) {\n      this.nativeCol = 0;\n      this.nativeColOff = 0;\n      this.nativeRow = 0;\n      this.nativeRowOff = 0;\n    } else if (typeof address === 'string') {\n      const decoded = colCache.decodeAddress(address);\n      this.nativeCol = decoded.col + offset;\n      this.nativeColOff = 0;\n      this.nativeRow = decoded.row + offset;\n      this.nativeRowOff = 0;\n    } else if (address.nativeCol !== undefined) {\n      this.nativeCol = address.nativeCol || 0;\n      this.nativeColOff = address.nativeColOff || 0;\n      this.nativeRow = address.nativeRow || 0;\n      this.nativeRowOff = address.nativeRowOff || 0;\n    } else if (address.col !== undefined) {\n      this.col = address.col + offset;\n      this.row = address.row + offset;\n    } else {\n      this.nativeCol = 0;\n      this.nativeColOff = 0;\n      this.nativeRow = 0;\n      this.nativeRowOff = 0;\n    }\n\n    this.worksheet = worksheet;\n  }\n\n  static asInstance(model) {\n    return model instanceof Anchor || model == null ? model : new Anchor(model);\n  }\n\n  get col() {\n    return this.nativeCol + (Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth);\n  }\n\n  set col(v) {\n    this.nativeCol = Math.floor(v);\n    this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\n  }\n\n  get row() {\n    return this.nativeRow + (Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight);\n  }\n\n  set row(v) {\n    this.nativeRow = Math.floor(v);\n    this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\n  }\n\n  get colWidth() {\n    return this.worksheet && this.worksheet.getColumn(this.nativeCol + 1) && this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth\n      ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000)\n      : 640000;\n  }\n\n  get rowHeight() {\n    return this.worksheet && this.worksheet.getRow(this.nativeRow + 1) && this.worksheet.getRow(this.nativeRow + 1).height\n      ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000)\n      : 180000;\n  }\n\n  get model() {\n    return {\n      nativeCol: this.nativeCol,\n      nativeColOff: this.nativeColOff,\n      nativeRow: this.nativeRow,\n      nativeRowOff: this.nativeRowOff,\n    };\n  }\n\n  set model(value) {\n    this.nativeCol = value.nativeCol;\n    this.nativeColOff = value.nativeColOff;\n    this.nativeRow = value.nativeRow;\n    this.nativeRowOff = value.nativeRowOff;\n  }\n}\n\nmodule.exports = Anchor;\n"],"mappings":"AAAA;;;;;;;;AAEA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;IAEMC,M;EACJ,gBAAYC,SAAZ,EAAuBC,OAAvB,EAA4C;IAAA,IAAZC,MAAY,uEAAH,CAAG;;IAAA;;IAC1C,IAAI,CAACD,OAAL,EAAc;MACZ,KAAKE,SAAL,GAAiB,CAAjB;MACA,KAAKC,YAAL,GAAoB,CAApB;MACA,KAAKC,SAAL,GAAiB,CAAjB;MACA,KAAKC,YAAL,GAAoB,CAApB;IACD,CALD,MAKO,IAAI,OAAOL,OAAP,KAAmB,QAAvB,EAAiC;MACtC,IAAMM,OAAO,GAAGV,QAAQ,CAACW,aAAT,CAAuBP,OAAvB,CAAhB;MACA,KAAKE,SAAL,GAAiBI,OAAO,CAACE,GAAR,GAAcP,MAA/B;MACA,KAAKE,YAAL,GAAoB,CAApB;MACA,KAAKC,SAAL,GAAiBE,OAAO,CAACG,GAAR,GAAcR,MAA/B;MACA,KAAKI,YAAL,GAAoB,CAApB;IACD,CANM,MAMA,IAAIL,OAAO,CAACE,SAAR,KAAsBQ,SAA1B,EAAqC;MAC1C,KAAKR,SAAL,GAAiBF,OAAO,CAACE,SAAR,IAAqB,CAAtC;MACA,KAAKC,YAAL,GAAoBH,OAAO,CAACG,YAAR,IAAwB,CAA5C;MACA,KAAKC,SAAL,GAAiBJ,OAAO,CAACI,SAAR,IAAqB,CAAtC;MACA,KAAKC,YAAL,GAAoBL,OAAO,CAACK,YAAR,IAAwB,CAA5C;IACD,CALM,MAKA,IAAIL,OAAO,CAACQ,GAAR,KAAgBE,SAApB,EAA+B;MACpC,KAAKF,GAAL,GAAWR,OAAO,CAACQ,GAAR,GAAcP,MAAzB;MACA,KAAKQ,GAAL,GAAWT,OAAO,CAACS,GAAR,GAAcR,MAAzB;IACD,CAHM,MAGA;MACL,KAAKC,SAAL,GAAiB,CAAjB;MACA,KAAKC,YAAL,GAAoB,CAApB;MACA,KAAKC,SAAL,GAAiB,CAAjB;MACA,KAAKC,YAAL,GAAoB,CAApB;IACD;;IAED,KAAKN,SAAL,GAAiBA,SAAjB;EACD;;;;SAMD,eAAU;MACR,OAAO,KAAKG,SAAL,GAAkBS,IAAI,CAACC,GAAL,CAAS,KAAKC,QAAL,GAAgB,CAAzB,EAA4B,KAAKV,YAAjC,IAAiD,KAAKU,QAA/E;IACD,C;SAED,aAAQC,CAAR,EAAW;MACT,KAAKZ,SAAL,GAAiBS,IAAI,CAACI,KAAL,CAAWD,CAAX,CAAjB;MACA,KAAKX,YAAL,GAAoBQ,IAAI,CAACI,KAAL,CAAW,CAACD,CAAC,GAAG,KAAKZ,SAAV,IAAuB,KAAKW,QAAvC,CAApB;IACD;;;SAED,eAAU;MACR,OAAO,KAAKT,SAAL,GAAkBO,IAAI,CAACC,GAAL,CAAS,KAAKI,SAAL,GAAiB,CAA1B,EAA6B,KAAKX,YAAlC,IAAkD,KAAKW,SAAhF;IACD,C;SAED,aAAQF,CAAR,EAAW;MACT,KAAKV,SAAL,GAAiBO,IAAI,CAACI,KAAL,CAAWD,CAAX,CAAjB;MACA,KAAKT,YAAL,GAAoBM,IAAI,CAACI,KAAL,CAAW,CAACD,CAAC,GAAG,KAAKV,SAAV,IAAuB,KAAKY,SAAvC,CAApB;IACD;;;SAED,eAAe;MACb,OAAO,KAAKjB,SAAL,IAAkB,KAAKA,SAAL,CAAekB,SAAf,CAAyB,KAAKf,SAAL,GAAiB,CAA1C,CAAlB,IAAkE,KAAKH,SAAL,CAAekB,SAAf,CAAyB,KAAKf,SAAL,GAAiB,CAA1C,EAA6CgB,aAA/G,GACHP,IAAI,CAACI,KAAL,CAAW,KAAKhB,SAAL,CAAekB,SAAf,CAAyB,KAAKf,SAAL,GAAiB,CAA1C,EAA6CiB,KAA7C,GAAqD,KAAhE,CADG,GAEH,MAFJ;IAGD;;;SAED,eAAgB;MACd,OAAO,KAAKpB,SAAL,IAAkB,KAAKA,SAAL,CAAeqB,MAAf,CAAsB,KAAKhB,SAAL,GAAiB,CAAvC,CAAlB,IAA+D,KAAKL,SAAL,CAAeqB,MAAf,CAAsB,KAAKhB,SAAL,GAAiB,CAAvC,EAA0CiB,MAAzG,GACHV,IAAI,CAACI,KAAL,CAAW,KAAKhB,SAAL,CAAeqB,MAAf,CAAsB,KAAKhB,SAAL,GAAiB,CAAvC,EAA0CiB,MAA1C,GAAmD,KAA9D,CADG,GAEH,MAFJ;IAGD;;;SAED,eAAY;MACV,OAAO;QACLnB,SAAS,EAAE,KAAKA,SADX;QAELC,YAAY,EAAE,KAAKA,YAFd;QAGLC,SAAS,EAAE,KAAKA,SAHX;QAILC,YAAY,EAAE,KAAKA;MAJd,CAAP;IAMD,C;SAED,aAAUiB,KAAV,EAAiB;MACf,KAAKpB,SAAL,GAAiBoB,KAAK,CAACpB,SAAvB;MACA,KAAKC,YAAL,GAAoBmB,KAAK,CAACnB,YAA1B;MACA,KAAKC,SAAL,GAAiBkB,KAAK,CAAClB,SAAvB;MACA,KAAKC,YAAL,GAAoBiB,KAAK,CAACjB,YAA1B;IACD;;;WAhDD,oBAAkBkB,KAAlB,EAAyB;MACvB,OAAOA,KAAK,YAAYzB,MAAjB,IAA2ByB,KAAK,IAAI,IAApC,GAA2CA,KAA3C,GAAmD,IAAIzB,MAAJ,CAAWyB,KAAX,CAA1D;IACD;;;;;;AAiDHC,MAAM,CAACC,OAAP,GAAiB3B,MAAjB"}