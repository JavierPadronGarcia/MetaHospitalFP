{"version":3,"file":"vml-note-xform.js","names":["BaseXform","require","VmlAnchorXform","VmlNoteXform","xmlStream","model","index","openNode","V_SHAPE_ATTRIBUTES","leafNode","color2","color","obscured","style","closeNode","ObjectType","vmlAnchorXform","render","refAddress","row","col","module","exports","id","type","fillcolor","strokecolor"],"sources":["../../../../../lib/xlsx/xform/comment/vml-note-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nconst VmlAnchorXform = require('./vml-anchor-xform');\n\n// render the triangle in the cell for the comment\nclass VmlNoteXform extends BaseXform {\n  get tag() {\n    return 'v:shape';\n  }\n\n  render(xmlStream, model, index) {\n    xmlStream.openNode('v:shape', VmlNoteXform.V_SHAPE_ATTRIBUTES(index));\n\n    xmlStream.leafNode('v:fill', {color2: 'infoBackground [80]'});\n    xmlStream.leafNode('v:shadow', {color: 'none [81]', obscured: 't'});\n    xmlStream.leafNode('v:path', {'o:connecttype': 'none'});\n\n    xmlStream.openNode('v:textbox', {style: 'mso-direction-alt:auto'});\n    xmlStream.leafNode('div', {style: 'text-align:left'});\n    xmlStream.closeNode();\n\n    xmlStream.openNode('x:ClientData', {ObjectType: 'Note'});\n    xmlStream.leafNode('x:MoveWithCells');\n    xmlStream.leafNode('x:SizeWithCells');\n\n    VmlNoteXform.vmlAnchorXform.render(xmlStream, model);\n\n    xmlStream.leafNode('x:AutoFill', null, 'False');\n    xmlStream.leafNode('x:Row', null, model.refAddress.row - 1);\n    xmlStream.leafNode('x:Column', null, model.refAddress.col - 1);\n    xmlStream.closeNode();\n\n    xmlStream.closeNode();\n  }\n}\n\nmodule.exports = VmlNoteXform;\n\nVmlNoteXform.V_SHAPE_ATTRIBUTES = index => ({\n  id: `_x0000_s${1025 + index}`,\n  type: '#_x0000_t202',\n  style: 'position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden',\n  fillcolor: 'infoBackground [80]',\n  strokecolor: 'none [81]',\n  'o:insetmode': 'auto',\n});\n\nVmlNoteXform.vmlAnchorXform = new VmlAnchorXform();"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB;;AAEA,IAAMC,cAAc,GAAGD,OAAO,CAAC,oBAAD,CAA9B,C,CAEA;;;IACME,Y;;;;;;;;;;;;;SACJ,eAAU;MACR,OAAO,SAAP;IACD;;;WAED,gBAAOC,SAAP,EAAkBC,KAAlB,EAAyBC,KAAzB,EAAgC;MAC9BF,SAAS,CAACG,QAAV,CAAmB,SAAnB,EAA8BJ,YAAY,CAACK,kBAAb,CAAgCF,KAAhC,CAA9B;MAEAF,SAAS,CAACK,QAAV,CAAmB,QAAnB,EAA6B;QAACC,MAAM,EAAE;MAAT,CAA7B;MACAN,SAAS,CAACK,QAAV,CAAmB,UAAnB,EAA+B;QAACE,KAAK,EAAE,WAAR;QAAqBC,QAAQ,EAAE;MAA/B,CAA/B;MACAR,SAAS,CAACK,QAAV,CAAmB,QAAnB,EAA6B;QAAC,iBAAiB;MAAlB,CAA7B;MAEAL,SAAS,CAACG,QAAV,CAAmB,WAAnB,EAAgC;QAACM,KAAK,EAAE;MAAR,CAAhC;MACAT,SAAS,CAACK,QAAV,CAAmB,KAAnB,EAA0B;QAACI,KAAK,EAAE;MAAR,CAA1B;MACAT,SAAS,CAACU,SAAV;MAEAV,SAAS,CAACG,QAAV,CAAmB,cAAnB,EAAmC;QAACQ,UAAU,EAAE;MAAb,CAAnC;MACAX,SAAS,CAACK,QAAV,CAAmB,iBAAnB;MACAL,SAAS,CAACK,QAAV,CAAmB,iBAAnB;MAEAN,YAAY,CAACa,cAAb,CAA4BC,MAA5B,CAAmCb,SAAnC,EAA8CC,KAA9C;MAEAD,SAAS,CAACK,QAAV,CAAmB,YAAnB,EAAiC,IAAjC,EAAuC,OAAvC;MACAL,SAAS,CAACK,QAAV,CAAmB,OAAnB,EAA4B,IAA5B,EAAkCJ,KAAK,CAACa,UAAN,CAAiBC,GAAjB,GAAuB,CAAzD;MACAf,SAAS,CAACK,QAAV,CAAmB,UAAnB,EAA+B,IAA/B,EAAqCJ,KAAK,CAACa,UAAN,CAAiBE,GAAjB,GAAuB,CAA5D;MACAhB,SAAS,CAACU,SAAV;MAEAV,SAAS,CAACU,SAAV;IACD;;;;EA5BwBd,S;;AA+B3BqB,MAAM,CAACC,OAAP,GAAiBnB,YAAjB;;AAEAA,YAAY,CAACK,kBAAb,GAAkC,UAAAF,KAAK;EAAA,OAAK;IAC1CiB,EAAE,oBAAa,OAAOjB,KAApB,CADwC;IAE1CkB,IAAI,EAAE,cAFoC;IAG1CX,KAAK,EAAE,iHAHmC;IAI1CY,SAAS,EAAE,qBAJ+B;IAK1CC,WAAW,EAAE,WAL6B;IAM1C,eAAe;EAN2B,CAAL;AAAA,CAAvC;;AASAvB,YAAY,CAACa,cAAb,GAA8B,IAAId,cAAJ,EAA9B"}