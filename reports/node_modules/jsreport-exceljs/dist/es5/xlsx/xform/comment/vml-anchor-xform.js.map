{"version":3,"file":"vml-anchor-xform.js","names":["BaseXform","require","VmlAnchorXform","anchor","l","Math","floor","left","lf","t","top","tf","r","right","rf","b","bottom","bf","ref","col","max","row","xmlStream","model","rect","getAnchorRect","getDefaultRect","refAddress","leafNode","join","module","exports"],"sources":["../../../../../lib/xlsx/xform/comment/vml-anchor-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\n// render the triangle in the cell for the comment\nclass VmlAnchorXform extends BaseXform {\n  get tag() {\n    return 'x:Anchor';\n  }\n\n  getAnchorRect(anchor) {\n    const l = Math.floor(anchor.left);\n    const lf = Math.floor((anchor.left - l) * 68);\n    const t = Math.floor(anchor.top);\n    const tf = Math.floor((anchor.top - t) * 18);\n    const r = Math.floor(anchor.right);\n    const rf = Math.floor((anchor.right - r) * 68);\n    const b = Math.floor(anchor.bottom);\n    const bf = Math.floor((anchor.bottom - b) * 18);\n    return [l, lf, t, tf, r, rf, b, bf];\n  }\n\n  getDefaultRect(ref) {\n    const l = ref.col;\n    const lf = 6;\n    const t = Math.max(ref.row - 2, 0);\n    const tf = 14;\n    const r = l + 2;\n    const rf = 2;\n    const b = t + 4;\n    const bf = 16;\n    return [l, lf, t, tf, r, rf, b, bf];\n  }\n\n  render(xmlStream, model) {\n    const rect = model.anchor ?\n      this.getAnchorRect(model.anchor) :\n      this.getDefaultRect(model.refAddress);\n\n    xmlStream.leafNode('x:Anchor', null, rect.join(', '));\n  }\n}\n\nmodule.exports = VmlAnchorXform;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB,C,CAEA;;;IACMC,c;;;;;;;;;;;;;SACJ,eAAU;MACR,OAAO,UAAP;IACD;;;WAED,uBAAcC,MAAd,EAAsB;MACpB,IAAMC,CAAC,GAAGC,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACI,IAAlB,CAAV;MACA,IAAMC,EAAE,GAAGH,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACI,IAAP,GAAcH,CAAf,IAAoB,EAA/B,CAAX;MACA,IAAMK,CAAC,GAAGJ,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACO,GAAlB,CAAV;MACA,IAAMC,EAAE,GAAGN,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACO,GAAP,GAAaD,CAAd,IAAmB,EAA9B,CAAX;MACA,IAAMG,CAAC,GAAGP,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACU,KAAlB,CAAV;MACA,IAAMC,EAAE,GAAGT,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACU,KAAP,GAAeD,CAAhB,IAAqB,EAAhC,CAAX;MACA,IAAMG,CAAC,GAAGV,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACa,MAAlB,CAAV;MACA,IAAMC,EAAE,GAAGZ,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACa,MAAP,GAAgBD,CAAjB,IAAsB,EAAjC,CAAX;MACA,OAAO,CAACX,CAAD,EAAII,EAAJ,EAAQC,CAAR,EAAWE,EAAX,EAAeC,CAAf,EAAkBE,EAAlB,EAAsBC,CAAtB,EAAyBE,EAAzB,CAAP;IACD;;;WAED,wBAAeC,GAAf,EAAoB;MAClB,IAAMd,CAAC,GAAGc,GAAG,CAACC,GAAd;MACA,IAAMX,EAAE,GAAG,CAAX;MACA,IAAMC,CAAC,GAAGJ,IAAI,CAACe,GAAL,CAASF,GAAG,CAACG,GAAJ,GAAU,CAAnB,EAAsB,CAAtB,CAAV;MACA,IAAMV,EAAE,GAAG,EAAX;MACA,IAAMC,CAAC,GAAGR,CAAC,GAAG,CAAd;MACA,IAAMU,EAAE,GAAG,CAAX;MACA,IAAMC,CAAC,GAAGN,CAAC,GAAG,CAAd;MACA,IAAMQ,EAAE,GAAG,EAAX;MACA,OAAO,CAACb,CAAD,EAAII,EAAJ,EAAQC,CAAR,EAAWE,EAAX,EAAeC,CAAf,EAAkBE,EAAlB,EAAsBC,CAAtB,EAAyBE,EAAzB,CAAP;IACD;;;WAED,gBAAOK,SAAP,EAAkBC,KAAlB,EAAyB;MACvB,IAAMC,IAAI,GAAGD,KAAK,CAACpB,MAAN,GACX,KAAKsB,aAAL,CAAmBF,KAAK,CAACpB,MAAzB,CADW,GAEX,KAAKuB,cAAL,CAAoBH,KAAK,CAACI,UAA1B,CAFF;MAIAL,SAAS,CAACM,QAAV,CAAmB,UAAnB,EAA+B,IAA/B,EAAqCJ,IAAI,CAACK,IAAL,CAAU,IAAV,CAArC;IACD;;;;EAnC0B7B,S;;AAsC7B8B,MAAM,CAACC,OAAP,GAAiB7B,cAAjB"}