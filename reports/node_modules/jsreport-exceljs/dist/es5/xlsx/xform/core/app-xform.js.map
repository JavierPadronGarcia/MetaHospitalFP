{"version":3,"file":"app-xform.js","names":["XmlStream","require","BaseXform","StringXform","AppHeadingPairsXform","AppTitleOfPartsXform","AppXform","map","Company","tag","Manager","HeadingPairs","TitleOfParts","xmlStream","model","openXml","StdDocAttributes","openNode","PROPERTY_ATTRIBUTES","leafNode","undefined","render","worksheets","company","manager","closeNode","node","parser","parseOpen","name","text","parseText","parseClose","DateFormat","dt","toISOString","replace","DateAttrs","xmlns","module","exports"],"sources":["../../../../../lib/xlsx/xform/core/app-xform.js"],"sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\nconst BaseXform = require('../base-xform');\nconst StringXform = require('../simple/string-xform');\n\nconst AppHeadingPairsXform = require('./app-heading-pairs-xform');\nconst AppTitleOfPartsXform = require('./app-titles-of-parts-xform');\n\nclass AppXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      Company: new StringXform({tag: 'Company'}),\n      Manager: new StringXform({tag: 'Manager'}),\n      HeadingPairs: new AppHeadingPairsXform(),\n      TitleOfParts: new AppTitleOfPartsXform(),\n    };\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openXml(XmlStream.StdDocAttributes);\n\n    xmlStream.openNode('Properties', AppXform.PROPERTY_ATTRIBUTES);\n\n    xmlStream.leafNode('Application', undefined, 'Microsoft Excel');\n    xmlStream.leafNode('DocSecurity', undefined, '0');\n    xmlStream.leafNode('ScaleCrop', undefined, 'false');\n\n    this.map.HeadingPairs.render(xmlStream, model.worksheets);\n    this.map.TitleOfParts.render(xmlStream, model.worksheets);\n    this.map.Company.render(xmlStream, model.company || '');\n    this.map.Manager.render(xmlStream, model.manager);\n\n    xmlStream.leafNode('LinksUpToDate', undefined, 'false');\n    xmlStream.leafNode('SharedDoc', undefined, 'false');\n    xmlStream.leafNode('HyperlinksChanged', undefined, 'false');\n    xmlStream.leafNode('AppVersion', undefined, '16.0300');\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case 'Properties':\n        return true;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n          return true;\n        }\n\n        // there's a lot we don't bother to parse\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case 'Properties':\n        this.model = {\n          worksheets: this.map.TitleOfParts.model,\n          company: this.map.Company.model,\n          manager: this.map.Manager.model,\n        };\n        return false;\n      default:\n        return true;\n    }\n  }\n}\n\nAppXform.DateFormat = function(dt) {\n  return dt.toISOString().replace(/[.]\\d{3,6}/, '');\n};\n\nAppXform.DateAttrs = {'xsi:type': 'dcterms:W3CDTF'};\n\nAppXform.PROPERTY_ATTRIBUTES = {\n  xmlns: 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties',\n  'xmlns:vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n};\n\nmodule.exports = AppXform;\n"],"mappings":"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"}