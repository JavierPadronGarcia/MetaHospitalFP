{"version":3,"file":"one-cell-anchor-xform.js","names":["BaseCellAnchorXform","require","StaticXform","CellPositionXform","ExtXform","PicXform","OneCellAnchorXform","map","tag","model","options","prepare","picture","xmlStream","openNode","editAs","range","render","tl","ext","closeNode","name","parser","parseClose","undefined","medium","reconcilePicture","module","exports"],"sources":["../../../../../lib/xlsx/xform/drawing/one-cell-anchor-xform.js"],"sourcesContent":["const BaseCellAnchorXform = require('./base-cell-anchor-xform');\nconst StaticXform = require('../static-xform');\n\nconst CellPositionXform = require('./cell-position-xform');\nconst ExtXform = require('./ext-xform');\nconst PicXform = require('./pic-xform');\n\nclass OneCellAnchorXform extends BaseCellAnchorXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xdr:from': new CellPositionXform({tag: 'xdr:from'}),\n      'xdr:ext': new ExtXform({tag: 'xdr:ext'}),\n      'xdr:pic': new PicXform(),\n      'xdr:clientData': new StaticXform({tag: 'xdr:clientData'}),\n    };\n  }\n\n  get tag() {\n    return 'xdr:oneCellAnchor';\n  }\n\n  prepare(model, options) {\n    this.map['xdr:pic'].prepare(model.picture, options);\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag, {editAs: model.range.editAs || 'oneCell'});\n\n    this.map['xdr:from'].render(xmlStream, model.range.tl);\n    this.map['xdr:ext'].render(xmlStream, model.range.ext);\n    this.map['xdr:pic'].render(xmlStream, model.picture);\n    this.map['xdr:clientData'].render(xmlStream, {});\n\n    xmlStream.closeNode();\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    switch (name) {\n      case this.tag:\n        this.model.range.tl = this.map['xdr:from'].model;\n        this.model.range.ext = this.map['xdr:ext'].model;\n        this.model.picture = this.map['xdr:pic'].model;\n        return false;\n      default:\n        // could be some unrecognised tags\n        return true;\n    }\n  }\n\n  reconcile(model, options) {\n    model.medium = this.reconcilePicture(model.picture, options);\n  }\n}\n\nmodule.exports = OneCellAnchorXform;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,mBAAmB,GAAGC,OAAO,CAAC,0BAAD,CAAnC;;AACA,IAAMC,WAAW,GAAGD,OAAO,CAAC,iBAAD,CAA3B;;AAEA,IAAME,iBAAiB,GAAGF,OAAO,CAAC,uBAAD,CAAjC;;AACA,IAAMG,QAAQ,GAAGH,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAMI,QAAQ,GAAGJ,OAAO,CAAC,aAAD,CAAxB;;IAEMK,kB;;;;;EACJ,8BAAc;IAAA;;IAAA;;IACZ;IAEA,MAAKC,GAAL,GAAW;MACT,YAAY,IAAIJ,iBAAJ,CAAsB;QAACK,GAAG,EAAE;MAAN,CAAtB,CADH;MAET,WAAW,IAAIJ,QAAJ,CAAa;QAACI,GAAG,EAAE;MAAN,CAAb,CAFF;MAGT,WAAW,IAAIH,QAAJ,EAHF;MAIT,kBAAkB,IAAIH,WAAJ,CAAgB;QAACM,GAAG,EAAE;MAAN,CAAhB;IAJT,CAAX;IAHY;EASb;;;;SAED,eAAU;MACR,OAAO,mBAAP;IACD;;;WAED,iBAAQC,KAAR,EAAeC,OAAf,EAAwB;MACtB,KAAKH,GAAL,CAAS,SAAT,EAAoBI,OAApB,CAA4BF,KAAK,CAACG,OAAlC,EAA2CF,OAA3C;IACD;;;WAED,gBAAOG,SAAP,EAAkBJ,KAAlB,EAAyB;MACvBI,SAAS,CAACC,QAAV,CAAmB,KAAKN,GAAxB,EAA6B;QAACO,MAAM,EAAEN,KAAK,CAACO,KAAN,CAAYD,MAAZ,IAAsB;MAA/B,CAA7B;MAEA,KAAKR,GAAL,CAAS,UAAT,EAAqBU,MAArB,CAA4BJ,SAA5B,EAAuCJ,KAAK,CAACO,KAAN,CAAYE,EAAnD;MACA,KAAKX,GAAL,CAAS,SAAT,EAAoBU,MAApB,CAA2BJ,SAA3B,EAAsCJ,KAAK,CAACO,KAAN,CAAYG,GAAlD;MACA,KAAKZ,GAAL,CAAS,SAAT,EAAoBU,MAApB,CAA2BJ,SAA3B,EAAsCJ,KAAK,CAACG,OAA5C;MACA,KAAKL,GAAL,CAAS,gBAAT,EAA2BU,MAA3B,CAAkCJ,SAAlC,EAA6C,EAA7C;MAEAA,SAAS,CAACO,SAAV;IACD;;;WAED,oBAAWC,IAAX,EAAiB;MACf,IAAI,KAAKC,MAAT,EAAiB;QACf,IAAI,CAAC,KAAKA,MAAL,CAAYC,UAAZ,CAAuBF,IAAvB,CAAL,EAAmC;UACjC,KAAKC,MAAL,GAAcE,SAAd;QACD;;QACD,OAAO,IAAP;MACD;;MACD,QAAQH,IAAR;QACE,KAAK,KAAKb,GAAV;UACE,KAAKC,KAAL,CAAWO,KAAX,CAAiBE,EAAjB,GAAsB,KAAKX,GAAL,CAAS,UAAT,EAAqBE,KAA3C;UACA,KAAKA,KAAL,CAAWO,KAAX,CAAiBG,GAAjB,GAAuB,KAAKZ,GAAL,CAAS,SAAT,EAAoBE,KAA3C;UACA,KAAKA,KAAL,CAAWG,OAAX,GAAqB,KAAKL,GAAL,CAAS,SAAT,EAAoBE,KAAzC;UACA,OAAO,KAAP;;QACF;UACE;UACA,OAAO,IAAP;MARJ;IAUD;;;WAED,mBAAUA,KAAV,EAAiBC,OAAjB,EAA0B;MACxBD,KAAK,CAACgB,MAAN,GAAe,KAAKC,gBAAL,CAAsBjB,KAAK,CAACG,OAA5B,EAAqCF,OAArC,CAAf;IACD;;;;EApD8BV,mB;;AAuDjC2B,MAAM,CAACC,OAAP,GAAiBtB,kBAAjB"}