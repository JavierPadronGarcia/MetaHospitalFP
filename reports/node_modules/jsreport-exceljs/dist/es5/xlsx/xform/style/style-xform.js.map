{"version":3,"file":"style-xform.js","names":["BaseXform","require","AlignmentXform","ProtectionXform","StyleXform","options","xfId","map","alignment","protection","xmlStream","model","openNode","numFmtId","fontId","fillId","borderId","addAttribute","render","closeNode","node","parser","parseOpen","name","parseInt","attributes","text","parseText","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/style-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nconst AlignmentXform = require('./alignment-xform');\nconst ProtectionXform = require('./protection-xform');\n\n// <xf numFmtId=\"[numFmtId]\" fontId=\"[fontId]\" fillId=\"[fillId]\" borderId=\"[xf.borderId]\" xfId=\"[xfId]\">\n//   Optional <alignment>\n//   Optional <protection>\n// </xf>\n\n// Style assists translation from style model to/from xlsx\nclass StyleXform extends BaseXform {\n  constructor(options) {\n    super();\n\n    this.xfId = !!(options && options.xfId);\n    this.map = {\n      alignment: new AlignmentXform(),\n      protection: new ProtectionXform (),\n    };\n  }\n\n  get tag() {\n    return 'xf';\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode('xf', {\n      numFmtId: model.numFmtId || 0,\n      fontId: model.fontId || 0,\n      fillId: model.fillId || 0,\n      borderId: model.borderId || 0,\n    });\n    if (this.xfId) {\n      xmlStream.addAttribute('xfId', model.xfId || 0);\n    }\n\n    if (model.numFmtId) {\n      xmlStream.addAttribute('applyNumberFormat', '1');\n    }\n    if (model.fontId) {\n      xmlStream.addAttribute('applyFont', '1');\n    }\n    if (model.fillId) {\n      xmlStream.addAttribute('applyFill', '1');\n    }\n    if (model.borderId) {\n      xmlStream.addAttribute('applyBorder', '1');\n    }\n    if (model.alignment) {\n      xmlStream.addAttribute('applyAlignment', '1');\n    }\n    if (model.protection) {\n      xmlStream.addAttribute('applyProtection', '1');\n    }\n\n    /**\n     * Rendering tags causes close of XML stream.\n     * Therefore adding attributes must be done before rendering tags.\n     */\n\n    if (model.alignment) {\n      this.map.alignment.render(xmlStream, model.alignment);\n    }\n    if (model.protection) {\n      this.map.protection.render(xmlStream, model.protection);\n    }\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    // used during sax parsing of xml to build font object\n    switch (node.name) {\n      case 'xf':\n        this.model = {\n          numFmtId: parseInt(node.attributes.numFmtId, 10),\n          fontId: parseInt(node.attributes.fontId, 10),\n          fillId: parseInt(node.attributes.fillId, 10),\n          borderId: parseInt(node.attributes.borderId, 10),\n        };\n        if (this.xfId) {\n          this.model.xfId = parseInt(node.attributes.xfId, 10);\n        }\n        return true;\n      case 'alignment':\n        this.parser = this.map.alignment;\n        this.parser.parseOpen(node);\n        return true;\n      case 'protection':\n        this.parser = this.map.protection;\n        this.parser.parseOpen(node);\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.model[name] = this.parser.model;\n        this.parser = undefined;\n      }\n      return true;\n    }\n    return name !== 'xf';\n  }\n}\n\nmodule.exports = StyleXform;\n"],"mappings":"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"}