{"version":3,"file":"color-xform.js","names":["BaseXform","require","ColorXform","name","xmlStream","model","openNode","argb","addAttribute","theme","undefined","tint","indexed","closeNode","node","attributes","rgb","parseInt","parseFloat","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/color-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\n// Color encapsulates translation from color model to/from xlsx\nclass ColorXform extends BaseXform {\n  constructor(name) {\n    super();\n\n    // this.name controls the xm node name\n    this.name = name || 'color';\n  }\n\n  get tag() {\n    return this.name;\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.openNode(this.name);\n      if (model.argb) {\n        xmlStream.addAttribute('rgb', model.argb);\n      } else if (model.theme !== undefined) {\n        xmlStream.addAttribute('theme', model.theme);\n        if (model.tint !== undefined) {\n          xmlStream.addAttribute('tint', model.tint);\n        }\n      } else if (model.indexed !== undefined) {\n        xmlStream.addAttribute('indexed', model.indexed);\n      } else {\n        xmlStream.addAttribute('auto', '1');\n      }\n      xmlStream.closeNode();\n      return true;\n    }\n    return false;\n  }\n\n  parseOpen(node) {\n    if (node.name === this.name) {\n      if (node.attributes.rgb) {\n        this.model = {argb: node.attributes.rgb};\n      } else if (node.attributes.theme) {\n        this.model = {theme: parseInt(node.attributes.theme, 10)};\n        if (node.attributes.tint) {\n          this.model.tint = parseFloat(node.attributes.tint);\n        }\n      } else if (node.attributes.indexed) {\n        this.model = {indexed: parseInt(node.attributes.indexed, 10)};\n      } else {\n        this.model = undefined;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = ColorXform;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB,C,CAEA;;;IACMC,U;;;;;EACJ,oBAAYC,IAAZ,EAAkB;IAAA;;IAAA;;IAChB,0BADgB,CAGhB;;IACA,MAAKA,IAAL,GAAYA,IAAI,IAAI,OAApB;IAJgB;EAKjB;;;;SAED,eAAU;MACR,OAAO,KAAKA,IAAZ;IACD;;;WAED,gBAAOC,SAAP,EAAkBC,KAAlB,EAAyB;MACvB,IAAIA,KAAJ,EAAW;QACTD,SAAS,CAACE,QAAV,CAAmB,KAAKH,IAAxB;;QACA,IAAIE,KAAK,CAACE,IAAV,EAAgB;UACdH,SAAS,CAACI,YAAV,CAAuB,KAAvB,EAA8BH,KAAK,CAACE,IAApC;QACD,CAFD,MAEO,IAAIF,KAAK,CAACI,KAAN,KAAgBC,SAApB,EAA+B;UACpCN,SAAS,CAACI,YAAV,CAAuB,OAAvB,EAAgCH,KAAK,CAACI,KAAtC;;UACA,IAAIJ,KAAK,CAACM,IAAN,KAAeD,SAAnB,EAA8B;YAC5BN,SAAS,CAACI,YAAV,CAAuB,MAAvB,EAA+BH,KAAK,CAACM,IAArC;UACD;QACF,CALM,MAKA,IAAIN,KAAK,CAACO,OAAN,KAAkBF,SAAtB,EAAiC;UACtCN,SAAS,CAACI,YAAV,CAAuB,SAAvB,EAAkCH,KAAK,CAACO,OAAxC;QACD,CAFM,MAEA;UACLR,SAAS,CAACI,YAAV,CAAuB,MAAvB,EAA+B,GAA/B;QACD;;QACDJ,SAAS,CAACS,SAAV;QACA,OAAO,IAAP;MACD;;MACD,OAAO,KAAP;IACD;;;WAED,mBAAUC,IAAV,EAAgB;MACd,IAAIA,IAAI,CAACX,IAAL,KAAc,KAAKA,IAAvB,EAA6B;QAC3B,IAAIW,IAAI,CAACC,UAAL,CAAgBC,GAApB,EAAyB;UACvB,KAAKX,KAAL,GAAa;YAACE,IAAI,EAAEO,IAAI,CAACC,UAAL,CAAgBC;UAAvB,CAAb;QACD,CAFD,MAEO,IAAIF,IAAI,CAACC,UAAL,CAAgBN,KAApB,EAA2B;UAChC,KAAKJ,KAAL,GAAa;YAACI,KAAK,EAAEQ,QAAQ,CAACH,IAAI,CAACC,UAAL,CAAgBN,KAAjB,EAAwB,EAAxB;UAAhB,CAAb;;UACA,IAAIK,IAAI,CAACC,UAAL,CAAgBJ,IAApB,EAA0B;YACxB,KAAKN,KAAL,CAAWM,IAAX,GAAkBO,UAAU,CAACJ,IAAI,CAACC,UAAL,CAAgBJ,IAAjB,CAA5B;UACD;QACF,CALM,MAKA,IAAIG,IAAI,CAACC,UAAL,CAAgBH,OAApB,EAA6B;UAClC,KAAKP,KAAL,GAAa;YAACO,OAAO,EAAEK,QAAQ,CAACH,IAAI,CAACC,UAAL,CAAgBH,OAAjB,EAA0B,EAA1B;UAAlB,CAAb;QACD,CAFM,MAEA;UACL,KAAKP,KAAL,GAAaK,SAAb;QACD;;QACD,OAAO,IAAP;MACD;;MACD,OAAO,KAAP;IACD;;;WAED,qBAAY,CAAE;;;WAEd,sBAAa;MACX,OAAO,KAAP;IACD;;;;EAxDsBV,S;;AA2DzBmB,MAAM,CAACC,OAAP,GAAiBlB,UAAjB"}