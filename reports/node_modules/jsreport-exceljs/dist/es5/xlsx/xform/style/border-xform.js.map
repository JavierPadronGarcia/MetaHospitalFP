{"version":3,"file":"border-xform.js","names":["BaseXform","require","ColorXform","EdgeXform","name","map","color","xmlStream","model","defaultColor","openNode","style","addAttribute","render","closeNode","node","parser","parseOpen","attributes","undefined","text","parseText","parseClose","value","validStyleValues","reduce","p","v","BorderXform","top","left","bottom","right","diagonal","up","down","add","edgeModel","edgeXform","reset","diagonalUp","diagonalDown","key","extensions","Object","assign","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/border-xform.js"],"sourcesContent":["/* eslint-disable max-classes-per-file */\nconst BaseXform = require('../base-xform');\n\nconst ColorXform = require('./color-xform');\n\nclass EdgeXform extends BaseXform {\n  constructor(name) {\n    super();\n\n    this.name = name;\n    this.map = {\n      color: new ColorXform(),\n    };\n  }\n\n  get tag() {\n    return this.name;\n  }\n\n  render(xmlStream, model, defaultColor) {\n    const color = (model && model.color) || defaultColor || this.defaultColor;\n    xmlStream.openNode(this.name);\n    if (model && model.style) {\n      xmlStream.addAttribute('style', model.style);\n      if (color) {\n        this.map.color.render(xmlStream, color);\n      }\n    }\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case this.name: {\n        const {style} = node.attributes;\n        if (style) {\n          this.model = {\n            style,\n          };\n        } else {\n          this.model = undefined;\n        }\n        return true;\n      }\n      case 'color':\n        this.parser = this.map.color;\n        this.parser.parseOpen(node);\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n\n    if (name === this.name) {\n      if (this.map.color.model) {\n        if (!this.model) {\n          this.model = {};\n        }\n        this.model.color = this.map.color.model;\n      }\n    }\n\n    return false;\n  }\n\n\n  validStyle(value) {\n    return EdgeXform.validStyleValues[value];\n  }\n}\n\nEdgeXform.validStyleValues = [\n  'thin',\n  'dotted',\n  'dashDot',\n  'hair',\n  'dashDotDot',\n  'slantDashDot',\n  'mediumDashed',\n  'mediumDashDotDot',\n  'mediumDashDot',\n  'medium',\n  'double',\n  'thick',\n].reduce((p, v) => {\n  p[v] = true;\n  return p;\n}, {});\n\n\n// Border encapsulates translation from border model to/from xlsx\nclass BorderXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      top: new EdgeXform('top'),\n      left: new EdgeXform('left'),\n      bottom: new EdgeXform('bottom'),\n      right: new EdgeXform('right'),\n      diagonal: new EdgeXform('diagonal'),\n    };\n  }\n\n  render(xmlStream, model) {\n    const {color} = model;\n    xmlStream.openNode('border');\n    if (model.diagonal && model.diagonal.style) {\n      if (model.diagonal.up) {\n        xmlStream.addAttribute('diagonalUp', '1');\n      }\n      if (model.diagonal.down) {\n        xmlStream.addAttribute('diagonalDown', '1');\n      }\n    }\n    function add(edgeModel, edgeXform) {\n      if (edgeModel && !edgeModel.color && model.color) {\n        // don't mess with incoming models\n        edgeModel = {\n          ...edgeModel,\n          color: model.color,\n        };\n      }\n      edgeXform.render(xmlStream, edgeModel, color);\n    }\n    add(model.left, this.map.left);\n    add(model.right, this.map.right);\n    add(model.top, this.map.top);\n    add(model.bottom, this.map.bottom);\n    add(model.diagonal, this.map.diagonal);\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case 'border':\n        this.reset();\n        this.diagonalUp = !!node.attributes.diagonalUp;\n        this.diagonalDown = !!node.attributes.diagonalDown;\n        return true;\n      default:\n        this.parser = this.map[node.name];\n        if (this.parser) {\n          this.parser.parseOpen(node);\n          return true;\n        }\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    if (name === 'border') {\n      const model = (this.model = {});\n      const add = function(key, edgeModel, extensions) {\n        if (edgeModel) {\n          if (extensions) {\n            Object.assign(edgeModel, extensions);\n          }\n          model[key] = edgeModel;\n        }\n      };\n      add('left', this.map.left.model);\n      add('right', this.map.right.model);\n      add('top', this.map.top.model);\n      add('bottom', this.map.bottom.model);\n      add('diagonal', this.map.diagonal.model, {up: this.diagonalUp, down: this.diagonalDown});\n    }\n    return false;\n  }\n}\n\nmodule.exports = BorderXform;\n"],"mappings":"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"}