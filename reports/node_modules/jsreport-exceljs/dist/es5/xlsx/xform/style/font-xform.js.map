{"version":3,"file":"font-xform.js","names":["ColorXform","require","BooleanXform","IntegerXform","StringXform","UnderlineXform","_","BaseXform","FontXform","options","OPTIONS","map","b","prop","xform","tag","attr","i","u","charset","color","condense","extend","family","outline","vertAlign","scheme","shadow","strike","sz","fontNameTag","tagName","xmlStream","model","openNode","each","defn","render","closeNode","node","parser","parseOpen","name","text","parseText","parseClose","item","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/font-xform.js"],"sourcesContent":["'use strict';\n\nconst ColorXform = require('./color-xform');\nconst BooleanXform = require('../simple/boolean-xform');\nconst IntegerXform = require('../simple/integer-xform');\nconst StringXform = require('../simple/string-xform');\nconst UnderlineXform = require('./underline-xform');\n\nconst _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\n// Font encapsulates translation from font model to xlsx\nclass FontXform extends BaseXform {\n  constructor(options) {\n    super();\n\n    this.options = options || FontXform.OPTIONS;\n\n    this.map = {\n      b: {prop: 'bold', xform: new BooleanXform({tag: 'b', attr: 'val'})},\n      i: {prop: 'italic', xform: new BooleanXform({tag: 'i', attr: 'val'})},\n      u: {prop: 'underline', xform: new UnderlineXform()},\n      charset: {prop: 'charset', xform: new IntegerXform({tag: 'charset', attr: 'val'})},\n      color: {prop: 'color', xform: new ColorXform()},\n      condense: {prop: 'condense', xform: new BooleanXform({tag: 'condense', attr: 'val'})},\n      extend: {prop: 'extend', xform: new BooleanXform({tag: 'extend', attr: 'val'})},\n      family: {prop: 'family', xform: new IntegerXform({tag: 'family', attr: 'val'})},\n      outline: {prop: 'outline', xform: new BooleanXform({tag: 'outline', attr: 'val'})},\n      vertAlign: {prop: 'vertAlign', xform: new StringXform({tag: 'vertAlign', attr: 'val'})},\n      scheme: {prop: 'scheme', xform: new StringXform({tag: 'scheme', attr: 'val'})},\n      shadow: {prop: 'shadow', xform: new BooleanXform({tag: 'shadow', attr: 'val'})},\n      strike: {prop: 'strike', xform: new BooleanXform({tag: 'strike', attr: 'val'})},\n      sz: {prop: 'size', xform: new IntegerXform({tag: 'sz', attr: 'val'})},\n    };\n    this.map[this.options.fontNameTag] = {prop: 'name', xform: new StringXform({tag: this.options.fontNameTag, attr: 'val'})};\n  }\n\n  get tag() {\n    return this.options.tagName;\n  }\n\n  render(xmlStream, model) {\n    const {map} = this;\n\n    xmlStream.openNode(this.options.tagName);\n    _.each(this.map, (defn, tag) => {\n      map[tag].xform.render(xmlStream, model[defn.prop]);\n    });\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    if (this.map[node.name]) {\n      this.parser = this.map[node.name].xform;\n      return this.parser.parseOpen(node);\n    }\n    switch (node.name) {\n      case this.options.tagName:\n        this.model = {};\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser && !this.parser.parseClose(name)) {\n      const item = this.map[name];\n      if (this.parser.model) {\n        this.model[item.prop] = this.parser.model;\n      }\n      this.parser = undefined;\n      return true;\n    }\n    switch (name) {\n      case this.options.tagName:\n        return false;\n      default:\n        return true;\n    }\n  }\n}\n\nFontXform.OPTIONS = {\n  tagName: 'font',\n  fontNameTag: 'name',\n};\n\nmodule.exports = FontXform;\n"],"mappings":"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"}