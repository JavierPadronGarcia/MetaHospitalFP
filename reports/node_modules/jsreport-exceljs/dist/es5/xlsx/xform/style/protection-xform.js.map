{"version":3,"file":"protection-xform.js","names":["BaseXform","require","validation","boolean","value","dflt","undefined","ProtectionXform","xmlStream","model","addRollback","openNode","isValid","add","name","addAttribute","locked","hidden","closeNode","commit","rollback","node","attributes","isSignificant","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/protection-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nconst validation = {\n  boolean(value, dflt) {\n    if (value === undefined) {\n      return dflt;\n    }\n    return value;\n  },\n};\n\n// Protection encapsulates translation from style.protection model to/from xlsx\nclass ProtectionXform extends BaseXform {\n  get tag() {\n    return 'protection';\n  }\n\n  render(xmlStream, model) {\n    xmlStream.addRollback();\n    xmlStream.openNode('protection');\n\n    let isValid = false;\n    function add(name, value) {\n      if (value !== undefined) {\n        xmlStream.addAttribute(name, value);\n        isValid = true;\n      }\n    }\n    add('locked', validation.boolean(model.locked, true) ? undefined : '0');\n    add('hidden', validation.boolean(model.hidden, false) ? '1' : undefined);\n\n    xmlStream.closeNode();\n\n    if (isValid) {\n      xmlStream.commit();\n    } else {\n      xmlStream.rollback();\n    }\n  }\n\n  parseOpen(node) {\n    const model = {\n      locked: !(node.attributes.locked === '0'),\n      hidden: (node.attributes.hidden === '1'),\n    };\n\n    // only want to record models that differ from defaults\n    const isSignificant = !model.locked || model.hidden;\n\n    this.model = isSignificant ? model : null;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = ProtectionXform;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB;;AAEA,IAAMC,UAAU,GAAG;EACjBC,OADiB,mBACTC,KADS,EACFC,IADE,EACI;IACnB,IAAID,KAAK,KAAKE,SAAd,EAAyB;MACvB,OAAOD,IAAP;IACD;;IACD,OAAOD,KAAP;EACD;AANgB,CAAnB,C,CASA;;IACMG,e;;;;;;;;;;;;;SACJ,eAAU;MACR,OAAO,YAAP;IACD;;;WAED,gBAAOC,SAAP,EAAkBC,KAAlB,EAAyB;MACvBD,SAAS,CAACE,WAAV;MACAF,SAAS,CAACG,QAAV,CAAmB,YAAnB;MAEA,IAAIC,OAAO,GAAG,KAAd;;MACA,SAASC,GAAT,CAAaC,IAAb,EAAmBV,KAAnB,EAA0B;QACxB,IAAIA,KAAK,KAAKE,SAAd,EAAyB;UACvBE,SAAS,CAACO,YAAV,CAAuBD,IAAvB,EAA6BV,KAA7B;UACAQ,OAAO,GAAG,IAAV;QACD;MACF;;MACDC,GAAG,CAAC,QAAD,EAAWX,UAAU,CAACC,OAAX,CAAmBM,KAAK,CAACO,MAAzB,EAAiC,IAAjC,IAAyCV,SAAzC,GAAqD,GAAhE,CAAH;MACAO,GAAG,CAAC,QAAD,EAAWX,UAAU,CAACC,OAAX,CAAmBM,KAAK,CAACQ,MAAzB,EAAiC,KAAjC,IAA0C,GAA1C,GAAgDX,SAA3D,CAAH;MAEAE,SAAS,CAACU,SAAV;;MAEA,IAAIN,OAAJ,EAAa;QACXJ,SAAS,CAACW,MAAV;MACD,CAFD,MAEO;QACLX,SAAS,CAACY,QAAV;MACD;IACF;;;WAED,mBAAUC,IAAV,EAAgB;MACd,IAAMZ,KAAK,GAAG;QACZO,MAAM,EAAE,EAAEK,IAAI,CAACC,UAAL,CAAgBN,MAAhB,KAA2B,GAA7B,CADI;QAEZC,MAAM,EAAGI,IAAI,CAACC,UAAL,CAAgBL,MAAhB,KAA2B;MAFxB,CAAd,CADc,CAMd;;MACA,IAAMM,aAAa,GAAG,CAACd,KAAK,CAACO,MAAP,IAAiBP,KAAK,CAACQ,MAA7C;MAEA,KAAKR,KAAL,GAAac,aAAa,GAAGd,KAAH,GAAW,IAArC;IACD;;;WAED,qBAAY,CAAE;;;WAEd,sBAAa;MACX,OAAO,KAAP;IACD;;;;EA5C2BT,S;;AA+C9BwB,MAAM,CAACC,OAAP,GAAiBlB,eAAjB"}