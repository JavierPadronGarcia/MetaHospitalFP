{"version":3,"file":"col-xform.js","names":["BaseXform","require","ColXform","model","options","styleId","styles","addStyleModel","style","xmlStream","openNode","addAttribute","min","max","width","hidden","bestFit","outlineLevel","collapsed","closeNode","node","name","parseInt","attributes","undefined","parseFloat","getStyleModel","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/col-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nclass ColXform extends BaseXform {\n  get tag() {\n    return 'col';\n  }\n\n  prepare(model, options) {\n    const styleId = options.styles.addStyleModel(model.style || {});\n    if (styleId) {\n      model.styleId = styleId;\n    }\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode('col');\n    xmlStream.addAttribute('min', model.min);\n    xmlStream.addAttribute('max', model.max);\n\n    if (model.width) {\n      // intead of writing the current width we write a placeholder\n      // so we can change it as the last step of sheet generation\n      xmlStream.addAttribute('width', model.width);\n    }\n    if (model.styleId) {\n      xmlStream.addAttribute('style', model.styleId);\n    }\n    if (model.hidden) {\n      xmlStream.addAttribute('hidden', '1');\n    }\n    if (model.bestFit) {\n      xmlStream.addAttribute('bestFit', '1');\n    }\n    if (model.outlineLevel) {\n      xmlStream.addAttribute('outlineLevel', model.outlineLevel);\n    }\n    if (model.collapsed) {\n      xmlStream.addAttribute('collapsed', '1');\n    }\n    xmlStream.addAttribute('customWidth', '1');\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (node.name === 'col') {\n      const model = (this.model = {\n        min: parseInt(node.attributes.min || '0', 10),\n        max: parseInt(node.attributes.max || '0', 10),\n        width: node.attributes.width === undefined ? undefined : parseFloat(node.attributes.width || '0'),\n      });\n      if (node.attributes.style) {\n        model.styleId = parseInt(node.attributes.style, 10);\n      }\n      if (node.attributes.hidden) {\n        model.hidden = true;\n      }\n      if (node.attributes.bestFit) {\n        model.bestFit = true;\n      }\n      if (node.attributes.outlineLevel) {\n        model.outlineLevel = parseInt(node.attributes.outlineLevel, 10);\n      }\n      if (node.attributes.collapsed) {\n        model.collapsed = true;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n\n  reconcile(model, options) {\n    // reconcile column styles\n    if (model.styleId) {\n      model.style = options.styles.getStyleModel(model.styleId);\n    }\n  }\n}\n\nmodule.exports = ColXform;\n"],"mappings":"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"}