{"version":3,"file":"conditional-formatting-ext-xform.js","names":["CompositeXform","require","SqRefExtXform","CfRuleExtXform","ConditionalFormattingExtXform","map","sqRef","cfRule","model","options","rules","forEach","rule","prepare","xmlStream","some","isExt","openNode","tag","filter","render","ref","closeNode","name","parser","push","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/conditional-formatting-ext-xform.js"],"sourcesContent":["const CompositeXform = require('../../composite-xform');\n\nconst SqRefExtXform = require('./sqref-ext-xform');\nconst CfRuleExtXform = require('./cf-rule-ext-xform');\n\nclass ConditionalFormattingExtXform extends CompositeXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xm:sqref': this.sqRef = new SqRefExtXform(),\n      'x14:cfRule': this.cfRule = new CfRuleExtXform(),\n    };\n  }\n\n  get tag() {\n    return 'x14:conditionalFormatting';\n  }\n\n  prepare(model, options) {\n    model.rules.forEach(rule =>{\n      this.cfRule.prepare(rule, options);\n    });\n  }\n\n  render(xmlStream, model) {\n    if (!model.rules.some(CfRuleExtXform.isExt)) {\n      return;\n    }\n\n    xmlStream.openNode(this.tag, {\n      'xmlns:xm': 'http://schemas.microsoft.com/office/excel/2006/main',\n    });\n\n    model.rules\n      .filter(CfRuleExtXform.isExt)\n      .forEach(rule => this.cfRule.render(xmlStream, rule));\n\n    // for some odd reason, Excel needs the <xm:sqref> node to be after the rules\n    this.sqRef.render(xmlStream, model.ref);\n\n    xmlStream.closeNode();\n  }\n\n  createNewModel() {\n    return {\n      rules: [],\n    };\n  }\n\n  onParserClose(name, parser) {\n    switch (name) {\n      case 'xm:sqref':\n        this.model.ref = parser.model;\n        break;\n\n      case 'x14:cfRule':\n        this.model.rules.push(parser.model);\n        break;\n    }\n  }\n}\n\nmodule.exports = ConditionalFormattingExtXform;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,cAAc,GAAGC,OAAO,CAAC,uBAAD,CAA9B;;AAEA,IAAMC,aAAa,GAAGD,OAAO,CAAC,mBAAD,CAA7B;;AACA,IAAME,cAAc,GAAGF,OAAO,CAAC,qBAAD,CAA9B;;IAEMG,6B;;;;;EACJ,yCAAc;IAAA;;IAAA;;IACZ;IAEA,MAAKC,GAAL,GAAW;MACT,YAAY,MAAKC,KAAL,GAAa,IAAIJ,aAAJ,EADhB;MAET,cAAc,MAAKK,MAAL,GAAc,IAAIJ,cAAJ;IAFnB,CAAX;IAHY;EAOb;;;;SAED,eAAU;MACR,OAAO,2BAAP;IACD;;;WAED,iBAAQK,KAAR,EAAeC,OAAf,EAAwB;MAAA;;MACtBD,KAAK,CAACE,KAAN,CAAYC,OAAZ,CAAoB,UAAAC,IAAI,EAAG;QACzB,MAAI,CAACL,MAAL,CAAYM,OAAZ,CAAoBD,IAApB,EAA0BH,OAA1B;MACD,CAFD;IAGD;;;WAED,gBAAOK,SAAP,EAAkBN,KAAlB,EAAyB;MAAA;;MACvB,IAAI,CAACA,KAAK,CAACE,KAAN,CAAYK,IAAZ,CAAiBZ,cAAc,CAACa,KAAhC,CAAL,EAA6C;QAC3C;MACD;;MAEDF,SAAS,CAACG,QAAV,CAAmB,KAAKC,GAAxB,EAA6B;QAC3B,YAAY;MADe,CAA7B;MAIAV,KAAK,CAACE,KAAN,CACGS,MADH,CACUhB,cAAc,CAACa,KADzB,EAEGL,OAFH,CAEW,UAAAC,IAAI;QAAA,OAAI,MAAI,CAACL,MAAL,CAAYa,MAAZ,CAAmBN,SAAnB,EAA8BF,IAA9B,CAAJ;MAAA,CAFf,EATuB,CAavB;;MACA,KAAKN,KAAL,CAAWc,MAAX,CAAkBN,SAAlB,EAA6BN,KAAK,CAACa,GAAnC;MAEAP,SAAS,CAACQ,SAAV;IACD;;;WAED,0BAAiB;MACf,OAAO;QACLZ,KAAK,EAAE;MADF,CAAP;IAGD;;;WAED,uBAAca,IAAd,EAAoBC,MAApB,EAA4B;MAC1B,QAAQD,IAAR;QACE,KAAK,UAAL;UACE,KAAKf,KAAL,CAAWa,GAAX,GAAiBG,MAAM,CAAChB,KAAxB;UACA;;QAEF,KAAK,YAAL;UACE,KAAKA,KAAL,CAAWE,KAAX,CAAiBe,IAAjB,CAAsBD,MAAM,CAAChB,KAA7B;UACA;MAPJ;IASD;;;;EAvDyCR,c;;AA0D5C0B,MAAM,CAACC,OAAP,GAAiBvB,6BAAjB"}