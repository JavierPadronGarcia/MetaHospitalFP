{"version":3,"file":"sheet-protection-xform.js","names":["_","require","BaseXform","booleanToXml","model","value","undefined","xmlToBoolean","equals","SheetProtectionXform","xmlStream","attributes","sheet","selectLockedCells","selectUnlockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables","algorithmName","hashValue","saltValue","spinCount","objects","scenarios","some","leafNode","tag","node","name","parseInt","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-protection-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\nfunction booleanToXml(model, value) {\n  return model ? value : undefined;\n}\n\nfunction xmlToBoolean(value, equals) {\n  return value === equals ? true : undefined;\n}\n\nclass SheetProtectionXform extends BaseXform {\n  get tag() {\n    return 'sheetProtection';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      const attributes = {\n        sheet: booleanToXml(model.sheet, '1'),\n        selectLockedCells: model.selectLockedCells === false ? '1' : undefined,\n        selectUnlockedCells: model.selectUnlockedCells === false ? '1' : undefined,\n        formatCells: booleanToXml(model.formatCells, '0'),\n        formatColumns: booleanToXml(model.formatColumns, '0'),\n        formatRows: booleanToXml(model.formatRows, '0'),\n        insertColumns: booleanToXml(model.insertColumns, '0'),\n        insertRows: booleanToXml(model.insertRows, '0'),\n        insertHyperlinks: booleanToXml(model.insertHyperlinks, '0'),\n        deleteColumns: booleanToXml(model.deleteColumns, '0'),\n        deleteRows: booleanToXml(model.deleteRows, '0'),\n        sort: booleanToXml(model.sort, '0'),\n        autoFilter: booleanToXml(model.autoFilter, '0'),\n        pivotTables: booleanToXml(model.pivotTables, '0'),\n      };\n      if(model.sheet){\n        attributes.algorithmName = model.algorithmName;\n        attributes.hashValue = model.hashValue;\n        attributes.saltValue = model.saltValue;\n        attributes.spinCount = model.spinCount;\n        attributes.objects = booleanToXml(model.objects === false, '1');\n        attributes.scenarios = booleanToXml(model.scenarios === false, '1');\n      }\n      if (_.some(attributes, value => value !== undefined)) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          sheet: xmlToBoolean(node.attributes.sheet, '1'),\n          objects: (node.attributes.objects === '1') ? false : undefined,\n          scenarios: (node.attributes.scenarios === '1') ? false : undefined,\n          selectLockedCells: (node.attributes.selectLockedCells === '1') ? false : undefined,\n          selectUnlockedCells: (node.attributes.selectUnlockedCells === '1') ? false : undefined,\n          formatCells: xmlToBoolean(node.attributes.formatCells, '0'),\n          formatColumns: xmlToBoolean(node.attributes.formatColumns, '0'),\n          formatRows: xmlToBoolean(node.attributes.formatRows, '0'),\n          insertColumns: xmlToBoolean(node.attributes.insertColumns, '0'),\n          insertRows: xmlToBoolean(node.attributes.insertRows, '0'),\n          insertHyperlinks: xmlToBoolean(node.attributes.insertHyperlinks, '0'),\n          deleteColumns: xmlToBoolean(node.attributes.deleteColumns, '0'),\n          deleteRows: xmlToBoolean(node.attributes.deleteRows, '0'),\n          sort: xmlToBoolean(node.attributes.sort, '0'),\n          autoFilter: xmlToBoolean(node.attributes.autoFilter, '0'),\n          pivotTables: xmlToBoolean(node.attributes.pivotTables, '0'),\n        };\n        if(node.attributes.algorithmName){\n          this.model.algorithmName = node.attributes.algorithmName;\n          this.model.hashValue = node.attributes.hashValue;\n          this.model.saltValue = node.attributes.saltValue;\n          this.model.spinCount = parseInt(node.attributes.spinCount, 10);\n        }\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = SheetProtectionXform;\n"],"mappings":"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"}