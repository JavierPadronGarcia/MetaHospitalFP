{"version":3,"file":"sheet-format-properties-xform.js","names":["_","require","BaseXform","SheetFormatPropertiesXform","xmlStream","model","attributes","defaultRowHeight","outlineLevelRow","outlineLevelCol","dyDescent","defaultColWidth","customHeight","some","value","undefined","leafNode","node","name","parseFloat","parseInt","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-format-properties-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\nclass SheetFormatPropertiesXform extends BaseXform {\n  get tag() {\n    return 'sheetFormatPr';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      const attributes = {\n        defaultRowHeight: model.defaultRowHeight,\n        outlineLevelRow: model.outlineLevelRow,\n        outlineLevelCol: model.outlineLevelCol,\n        'x14ac:dyDescent': model.dyDescent,\n      };\n      if (model.defaultColWidth) {\n        attributes.defaultColWidth = model.defaultColWidth;\n      }\n\n      // default value for 'defaultRowHeight' is 15, this should not be 'custom'\n      if (!model.defaultRowHeight || (model.defaultRowHeight !== 15)) {\n        attributes.customHeight = '1';\n      }\n\n      if (_.some(attributes, value => value !== undefined)) {\n        xmlStream.leafNode('sheetFormatPr', attributes);\n      }\n    }\n  }\n\n  parseOpen(node) {\n    if (node.name === 'sheetFormatPr') {\n      this.model = {\n        defaultRowHeight: parseFloat(node.attributes.defaultRowHeight || '0'),\n        dyDescent: parseFloat(node.attributes['x14ac:dyDescent'] || '0'),\n        outlineLevelRow: parseInt(node.attributes.outlineLevelRow || '0', 10),\n        outlineLevelCol: parseInt(node.attributes.outlineLevelCol || '0', 10),\n      };\n      if (node.attributes.defaultColWidth) {\n        this.model.defaultColWidth = parseFloat(node.attributes.defaultColWidth);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = SheetFormatPropertiesXform;\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,CAAC,GAAGC,OAAO,CAAC,2BAAD,CAAjB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAD,CAAzB;;IAEME,0B;;;;;;;;;;;;;SACJ,eAAU;MACR,OAAO,eAAP;IACD;;;WAED,gBAAOC,SAAP,EAAkBC,KAAlB,EAAyB;MACvB,IAAIA,KAAJ,EAAW;QACT,IAAMC,UAAU,GAAG;UACjBC,gBAAgB,EAAEF,KAAK,CAACE,gBADP;UAEjBC,eAAe,EAAEH,KAAK,CAACG,eAFN;UAGjBC,eAAe,EAAEJ,KAAK,CAACI,eAHN;UAIjB,mBAAmBJ,KAAK,CAACK;QAJR,CAAnB;;QAMA,IAAIL,KAAK,CAACM,eAAV,EAA2B;UACzBL,UAAU,CAACK,eAAX,GAA6BN,KAAK,CAACM,eAAnC;QACD,CATQ,CAWT;;;QACA,IAAI,CAACN,KAAK,CAACE,gBAAP,IAA4BF,KAAK,CAACE,gBAAN,KAA2B,EAA3D,EAAgE;UAC9DD,UAAU,CAACM,YAAX,GAA0B,GAA1B;QACD;;QAED,IAAIZ,CAAC,CAACa,IAAF,CAAOP,UAAP,EAAmB,UAAAQ,KAAK;UAAA,OAAIA,KAAK,KAAKC,SAAd;QAAA,CAAxB,CAAJ,EAAsD;UACpDX,SAAS,CAACY,QAAV,CAAmB,eAAnB,EAAoCV,UAApC;QACD;MACF;IACF;;;WAED,mBAAUW,IAAV,EAAgB;MACd,IAAIA,IAAI,CAACC,IAAL,KAAc,eAAlB,EAAmC;QACjC,KAAKb,KAAL,GAAa;UACXE,gBAAgB,EAAEY,UAAU,CAACF,IAAI,CAACX,UAAL,CAAgBC,gBAAhB,IAAoC,GAArC,CADjB;UAEXG,SAAS,EAAES,UAAU,CAACF,IAAI,CAACX,UAAL,CAAgB,iBAAhB,KAAsC,GAAvC,CAFV;UAGXE,eAAe,EAAEY,QAAQ,CAACH,IAAI,CAACX,UAAL,CAAgBE,eAAhB,IAAmC,GAApC,EAAyC,EAAzC,CAHd;UAIXC,eAAe,EAAEW,QAAQ,CAACH,IAAI,CAACX,UAAL,CAAgBG,eAAhB,IAAmC,GAApC,EAAyC,EAAzC;QAJd,CAAb;;QAMA,IAAIQ,IAAI,CAACX,UAAL,CAAgBK,eAApB,EAAqC;UACnC,KAAKN,KAAL,CAAWM,eAAX,GAA6BQ,UAAU,CAACF,IAAI,CAACX,UAAL,CAAgBK,eAAjB,CAAvC;QACD;;QACD,OAAO,IAAP;MACD;;MACD,OAAO,KAAP;IACD;;;WAED,qBAAY,CAAE;;;WAEd,sBAAa;MACX,OAAO,KAAP;IACD;;;;EAhDsCT,S;;AAmDzCmB,MAAM,CAACC,OAAP,GAAiBnB,0BAAjB"}