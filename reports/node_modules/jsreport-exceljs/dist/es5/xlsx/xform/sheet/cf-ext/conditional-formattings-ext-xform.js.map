{"version":3,"file":"conditional-formattings-ext-xform.js","names":["CompositeXform","require","CfRuleExtXform","ConditionalFormattingExtXform","ConditionalFormattingsExtXform","map","cfXform","model","hasExtContent","undefined","some","cf","rules","isExt","options","forEach","prepare","xmlStream","hasContent","openNode","tag","render","closeNode","name","parser","push","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/conditional-formattings-ext-xform.js"],"sourcesContent":["const CompositeXform = require('../../composite-xform');\r\n\r\nconst CfRuleExtXform = require('./cf-rule-ext-xform');\r\nconst ConditionalFormattingExtXform = require('./conditional-formatting-ext-xform');\r\n\r\nclass ConditionalFormattingsExtXform extends CompositeXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      'x14:conditionalFormatting': this.cfXform = new ConditionalFormattingExtXform(),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'x14:conditionalFormattings';\r\n  }\r\n\r\n  hasContent(model) {\r\n    if (model.hasExtContent === undefined) {\r\n      model.hasExtContent = model.some(\r\n        cf => cf.rules.some(CfRuleExtXform.isExt)\r\n      );\r\n    }\r\n    return model.hasExtContent;\r\n  }\r\n\r\n  prepare(model, options) {\r\n    model.forEach(cf =>{\r\n      this.cfXform.prepare(cf, options);\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (this.hasContent(model)) {\r\n      xmlStream.openNode(this.tag);\r\n      model.forEach(cf => this.cfXform.render(xmlStream, cf));\r\n      xmlStream.closeNode();\r\n    }\r\n  }\r\n\r\n  createNewModel() {\r\n    return [];\r\n  }\r\n\r\n  onParserClose(name, parser) {\r\n    // model is array of conditional formatting objects\r\n    this.model.push(parser.model);\r\n  }\r\n}\r\n\r\nmodule.exports = ConditionalFormattingsExtXform;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,cAAc,GAAGC,OAAO,CAAC,uBAAD,CAA9B;;AAEA,IAAMC,cAAc,GAAGD,OAAO,CAAC,qBAAD,CAA9B;;AACA,IAAME,6BAA6B,GAAGF,OAAO,CAAC,oCAAD,CAA7C;;IAEMG,8B;;;;;EACJ,0CAAc;IAAA;;IAAA;;IACZ;IAEA,MAAKC,GAAL,GAAW;MACT,6BAA6B,MAAKC,OAAL,GAAe,IAAIH,6BAAJ;IADnC,CAAX;IAHY;EAMb;;;;SAED,eAAU;MACR,OAAO,4BAAP;IACD;;;WAED,oBAAWI,KAAX,EAAkB;MAChB,IAAIA,KAAK,CAACC,aAAN,KAAwBC,SAA5B,EAAuC;QACrCF,KAAK,CAACC,aAAN,GAAsBD,KAAK,CAACG,IAAN,CACpB,UAAAC,EAAE;UAAA,OAAIA,EAAE,CAACC,KAAH,CAASF,IAAT,CAAcR,cAAc,CAACW,KAA7B,CAAJ;QAAA,CADkB,CAAtB;MAGD;;MACD,OAAON,KAAK,CAACC,aAAb;IACD;;;WAED,iBAAQD,KAAR,EAAeO,OAAf,EAAwB;MAAA;;MACtBP,KAAK,CAACQ,OAAN,CAAc,UAAAJ,EAAE,EAAG;QACjB,MAAI,CAACL,OAAL,CAAaU,OAAb,CAAqBL,EAArB,EAAyBG,OAAzB;MACD,CAFD;IAGD;;;WAED,gBAAOG,SAAP,EAAkBV,KAAlB,EAAyB;MAAA;;MACvB,IAAI,KAAKW,UAAL,CAAgBX,KAAhB,CAAJ,EAA4B;QAC1BU,SAAS,CAACE,QAAV,CAAmB,KAAKC,GAAxB;QACAb,KAAK,CAACQ,OAAN,CAAc,UAAAJ,EAAE;UAAA,OAAI,MAAI,CAACL,OAAL,CAAae,MAAb,CAAoBJ,SAApB,EAA+BN,EAA/B,CAAJ;QAAA,CAAhB;QACAM,SAAS,CAACK,SAAV;MACD;IACF;;;WAED,0BAAiB;MACf,OAAO,EAAP;IACD;;;WAED,uBAAcC,IAAd,EAAoBC,MAApB,EAA4B;MAC1B;MACA,KAAKjB,KAAL,CAAWkB,IAAX,CAAgBD,MAAM,CAACjB,KAAvB;IACD;;;;EA3C0CP,c;;AA8C7C0B,MAAM,CAACC,OAAP,GAAiBvB,8BAAjB"}