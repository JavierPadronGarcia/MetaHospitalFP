{"version":3,"file":"page-setup-xform.js","names":["_","require","BaseXform","booleanToXml","model","undefined","pageOrderToXml","cellCommentsToXml","errorsToXml","pageSizeToModel","value","parseInt","PageSetupXform","xmlStream","attributes","paperSize","orientation","horizontalDpi","verticalDpi","pageOrder","blackAndWhite","draft","cellComments","errors","scale","fitToWidth","fitToHeight","firstPageNumber","useFirstPageNumber","usePrinterDefaults","copies","some","leafNode","tag","node","name","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/page-setup-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\nfunction booleanToXml(model) {\n  return model ? '1' : undefined;\n}\nfunction pageOrderToXml(model) {\n  switch (model) {\n    case 'overThenDown':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction cellCommentsToXml(model) {\n  switch (model) {\n    case 'atEnd':\n    case 'asDisplyed':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction errorsToXml(model) {\n  switch (model) {\n    case 'dash':\n    case 'blank':\n    case 'NA':\n      return model;\n    default:\n      return undefined;\n  }\n}\nfunction pageSizeToModel(value) {\n  return value !== undefined ? parseInt(value, 10) : undefined;\n}\n\nclass PageSetupXform extends BaseXform {\n  get tag() {\n    return 'pageSetup';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      const attributes = {\n        paperSize: model.paperSize,\n        orientation: model.orientation,\n        horizontalDpi: model.horizontalDpi,\n        verticalDpi: model.verticalDpi,\n        pageOrder: pageOrderToXml(model.pageOrder),\n        blackAndWhite: booleanToXml(model.blackAndWhite),\n        draft: booleanToXml(model.draft),\n        cellComments: cellCommentsToXml(model.cellComments),\n        errors: errorsToXml(model.errors),\n        scale: model.scale,\n        fitToWidth: model.fitToWidth,\n        fitToHeight: model.fitToHeight,\n        firstPageNumber: model.firstPageNumber,\n        useFirstPageNumber: booleanToXml(model.firstPageNumber),\n        usePrinterDefaults: booleanToXml(model.usePrinterDefaults),\n        copies: model.copies,\n      };\n      if (_.some(attributes, value => value !== undefined)) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          paperSize: pageSizeToModel(node.attributes.paperSize),\n          orientation: node.attributes.orientation || 'portrait',\n          horizontalDpi: parseInt(node.attributes.horizontalDpi || '4294967295', 10),\n          verticalDpi: parseInt(node.attributes.verticalDpi || '4294967295', 10),\n          pageOrder: node.attributes.pageOrder || 'downThenOver',\n          blackAndWhite: node.attributes.blackAndWhite === '1',\n          draft: node.attributes.draft === '1',\n          cellComments: node.attributes.cellComments || 'None',\n          errors: node.attributes.errors || 'displayed',\n          scale: parseInt(node.attributes.scale || '100', 10),\n          fitToWidth: parseInt(node.attributes.fitToWidth || '1', 10),\n          fitToHeight: parseInt(node.attributes.fitToHeight || '1', 10),\n          firstPageNumber: parseInt(node.attributes.firstPageNumber || '1', 10),\n          useFirstPageNumber: node.attributes.useFirstPageNumber === '1',\n          usePrinterDefaults: node.attributes.usePrinterDefaults === '1',\n          copies: parseInt(node.attributes.copies || '1', 10),\n        };\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = PageSetupXform;\n"],"mappings":"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"}