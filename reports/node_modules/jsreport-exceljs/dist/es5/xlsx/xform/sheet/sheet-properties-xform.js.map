{"version":3,"file":"sheet-properties-xform.js","names":["BaseXform","require","ColorXform","PageSetupPropertiesXform","OutlinePropertiesXform","SheetPropertiesXform","map","tabColor","pageSetUpPr","outlinePr","xmlStream","model","addRollback","openNode","inner","render","pageSetup","outlineProperties","closeNode","commit","rollback","node","parser","parseOpen","name","tag","reset","text","parseText","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-properties-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\nconst ColorXform = require('../style/color-xform');\nconst PageSetupPropertiesXform = require('./page-setup-properties-xform');\nconst OutlinePropertiesXform = require('./outline-properties-xform');\n\nclass SheetPropertiesXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.map = {\n      tabColor: new ColorXform('tabColor'),\n      pageSetUpPr: new PageSetupPropertiesXform(),\n      outlinePr: new OutlinePropertiesXform(),\n    };\n  }\n\n  get tag() {\n    return 'sheetPr';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.addRollback();\n      xmlStream.openNode('sheetPr');\n\n      let inner = false;\n      inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;\n      inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;\n      inner = this.map.outlinePr.render(xmlStream, model.outlineProperties) || inner;\n\n      if (inner) {\n        xmlStream.closeNode();\n        xmlStream.commit();\n      } else {\n        xmlStream.rollback();\n      }\n    }\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    if (node.name === this.tag) {\n      this.reset();\n      return true;\n    }\n    if (this.map[node.name]) {\n      this.parser = this.map[node.name];\n      this.parser.parseOpen(node);\n      return true;\n    }\n    return false;\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n      return true;\n    }\n    return false;\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.parser = undefined;\n      }\n      return true;\n    }\n    if (this.map.tabColor.model || this.map.pageSetUpPr.model || this.map.outlinePr.model) {\n      this.model = {};\n      if (this.map.tabColor.model) {\n        this.model.tabColor = this.map.tabColor.model;\n      }\n      if (this.map.pageSetUpPr.model) {\n        this.model.pageSetup = this.map.pageSetUpPr.model;\n      }\n      if (this.map.outlinePr.model) {\n        this.model.outlineProperties = this.map.outlinePr.model;\n      }\n    } else {\n      this.model = null;\n    }\n    return false;\n  }\n}\n\nmodule.exports = SheetPropertiesXform;\n"],"mappings":"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"}