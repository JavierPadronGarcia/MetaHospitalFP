{"version":3,"file":"auto-filter-xform.js","names":["colCache","require","BaseXform","AutoFilterXform","xmlStream","model","leafNode","ref","getAddress","addr","row","column","address","firstAddress","from","secondAddress","to","node","name","attributes","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/auto-filter-xform.js"],"sourcesContent":["const colCache = require('../../../utils/col-cache');\nconst BaseXform = require('../base-xform');\n\nclass AutoFilterXform extends BaseXform {\n  get tag() {\n    return 'autoFilter';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      if (typeof model === 'string') {\n        // assume range\n        xmlStream.leafNode('autoFilter', {ref: model});\n      } else {\n        const getAddress = function(addr) {\n          if (typeof addr === 'string') {\n            return addr;\n          }\n          return colCache.getAddress(addr.row, addr.column).address;\n        };\n\n        const firstAddress = getAddress(model.from);\n        const secondAddress = getAddress(model.to);\n        if (firstAddress && secondAddress) {\n          xmlStream.leafNode('autoFilter', {ref: `${firstAddress}:${secondAddress}`});\n        }\n      }\n    }\n  }\n\n  parseOpen(node) {\n    if (node.name === 'autoFilter') {\n      this.model = node.attributes.ref;\n    }\n  }\n}\n\nmodule.exports = AutoFilterXform;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,0BAAD,CAAxB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAD,CAAzB;;IAEME,e;;;;;;;;;;;;;SACJ,eAAU;MACR,OAAO,YAAP;IACD;;;WAED,gBAAOC,SAAP,EAAkBC,KAAlB,EAAyB;MACvB,IAAIA,KAAJ,EAAW;QACT,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;UAC7B;UACAD,SAAS,CAACE,QAAV,CAAmB,YAAnB,EAAiC;YAACC,GAAG,EAAEF;UAAN,CAAjC;QACD,CAHD,MAGO;UACL,IAAMG,UAAU,GAAG,SAAbA,UAAa,CAASC,IAAT,EAAe;YAChC,IAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;cAC5B,OAAOA,IAAP;YACD;;YACD,OAAOT,QAAQ,CAACQ,UAAT,CAAoBC,IAAI,CAACC,GAAzB,EAA8BD,IAAI,CAACE,MAAnC,EAA2CC,OAAlD;UACD,CALD;;UAOA,IAAMC,YAAY,GAAGL,UAAU,CAACH,KAAK,CAACS,IAAP,CAA/B;UACA,IAAMC,aAAa,GAAGP,UAAU,CAACH,KAAK,CAACW,EAAP,CAAhC;;UACA,IAAIH,YAAY,IAAIE,aAApB,EAAmC;YACjCX,SAAS,CAACE,QAAV,CAAmB,YAAnB,EAAiC;cAACC,GAAG,YAAKM,YAAL,cAAqBE,aAArB;YAAJ,CAAjC;UACD;QACF;MACF;IACF;;;WAED,mBAAUE,IAAV,EAAgB;MACd,IAAIA,IAAI,CAACC,IAAL,KAAc,YAAlB,EAAgC;QAC9B,KAAKb,KAAL,GAAaY,IAAI,CAACE,UAAL,CAAgBZ,GAA7B;MACD;IACF;;;;EA/B2BL,S;;AAkC9BkB,MAAM,CAACC,OAAP,GAAiBlB,eAAjB"}