{"version":3,"file":"header-footer-xform.js","names":["BaseXform","require","HeaderFooterXform","xmlStream","model","addRollback","createTag","openNode","differentFirst","addAttribute","differentOddEven","oddHeader","leafNode","oddFooter","evenHeader","evenFooter","firstHeader","firstFooter","closeNode","commit","rollback","node","name","attributes","parseInt","currentNode","text","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/header-footer-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nclass HeaderFooterXform extends BaseXform {\n  get tag() {\n    return 'headerFooter';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.addRollback();\n\n      let createTag = false;\n\n      xmlStream.openNode('headerFooter');\n      if (model.differentFirst) {\n        xmlStream.addAttribute('differentFirst', '1');\n        createTag = true;\n      }\n      if (model.differentOddEven) {\n        xmlStream.addAttribute('differentOddEven', '1');\n        createTag = true;\n      }\n      if (model.oddHeader && typeof model.oddHeader === 'string') {\n        xmlStream.leafNode('oddHeader', null, model.oddHeader);\n        createTag = true;\n      }\n      if (model.oddFooter && typeof model.oddFooter === 'string') {\n        xmlStream.leafNode('oddFooter', null, model.oddFooter);\n        createTag = true;\n      }\n      if (model.evenHeader && typeof model.evenHeader === 'string') {\n        xmlStream.leafNode('evenHeader', null, model.evenHeader);\n        createTag = true;\n      }\n      if (model.evenFooter && typeof model.evenFooter === 'string') {\n        xmlStream.leafNode('evenFooter', null, model.evenFooter);\n        createTag = true;\n      }\n      if (model.firstHeader && typeof model.firstHeader === 'string') {\n        xmlStream.leafNode('firstHeader', null, model.firstHeader);\n        createTag = true;\n      }\n      if (model.firstFooter && typeof model.firstFooter === 'string') {\n        xmlStream.leafNode('firstFooter', null, model.firstFooter);\n        createTag = true;\n      }\n\n      if (createTag) {\n        xmlStream.closeNode();\n        xmlStream.commit();\n      } else {\n        xmlStream.rollback();\n      }\n    }\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case 'headerFooter':\n        this.model = {};\n        if (node.attributes.differentFirst) {\n          this.model.differentFirst = parseInt(node.attributes.differentFirst, 0) === 1;\n        }\n        if (node.attributes.differentOddEven) {\n          this.model.differentOddEven = parseInt(node.attributes.differentOddEven, 0) === 1;\n        }\n        return true;\n\n      case 'oddHeader':\n        this.currentNode = 'oddHeader';\n        return true;\n\n      case 'oddFooter':\n        this.currentNode = 'oddFooter';\n        return true;\n\n      case 'evenHeader':\n        this.currentNode = 'evenHeader';\n        return true;\n\n      case 'evenFooter':\n        this.currentNode = 'evenFooter';\n        return true;\n\n      case 'firstHeader':\n        this.currentNode = 'firstHeader';\n        return true;\n\n      case 'firstFooter':\n        this.currentNode = 'firstFooter';\n        return true;\n\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    switch (this.currentNode) {\n      case 'oddHeader':\n        this.model.oddHeader = text;\n        break;\n\n      case 'oddFooter':\n        this.model.oddFooter = text;\n        break;\n\n      case 'evenHeader':\n        this.model.evenHeader = text;\n        break;\n\n      case 'evenFooter':\n        this.model.evenFooter = text;\n        break;\n\n      case 'firstHeader':\n        this.model.firstHeader = text;\n        break;\n\n      case 'firstFooter':\n        this.model.firstFooter = text;\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  parseClose() {\n    switch (this.currentNode) {\n      case 'oddHeader':\n      case 'oddFooter':\n      case 'evenHeader':\n      case 'evenFooter':\n      case 'firstHeader':\n      case 'firstFooter':\n        this.currentNode = undefined;\n        return true;\n\n      default:\n        return false;\n    }\n  }\n}\n\nmodule.exports = HeaderFooterXform;"],"mappings":"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"}