{"version":3,"file":"databar-ext-xform.js","names":["BaseXform","require","CompositeXform","ColorXform","CfvoExtXform","DatabarExtXform","map","cfvoXform","borderColorXform","negativeBorderColorXform","negativeFillColorXform","axisColorXform","xmlStream","model","openNode","tag","minLength","toIntAttribute","maxLength","border","toBoolAttribute","gradient","negativeBarColorSameAsPositive","negativeBarBorderColorSameAsPositive","axisPosition","toAttribute","direction","cfvo","forEach","render","borderColor","negativeBorderColor","negativeFillColor","axisColor","closeNode","attributes","toIntValue","toBoolValue","toStringValue","name","parser","split","prop","push","rule","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/databar-ext-xform.js"],"sourcesContent":["const BaseXform = require('../../base-xform');\nconst CompositeXform = require('../../composite-xform');\n\nconst ColorXform = require('../../style/color-xform');\nconst CfvoExtXform = require('./cfvo-ext-xform');\n\nclass DatabarExtXform extends CompositeXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'x14:cfvo': this.cfvoXform = new CfvoExtXform(),\n      'x14:borderColor': this.borderColorXform = new ColorXform('x14:borderColor'),\n      'x14:negativeBorderColor': this.negativeBorderColorXform = new ColorXform('x14:negativeBorderColor'),\n      'x14:negativeFillColor': this.negativeFillColorXform = new ColorXform('x14:negativeFillColor'),\n      'x14:axisColor': this.axisColorXform = new ColorXform('x14:axisColor'),\n    };\n  }\n\n  static isExt(rule) {\n    // not all databars need ext\n    // TODO: refine this\n    return !rule.gradient;\n  }\n\n  get tag() {\n    return 'x14:dataBar';\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode(this.tag, {\n      minLength: BaseXform.toIntAttribute(model.minLength, 0, true),\n      maxLength: BaseXform.toIntAttribute(model.maxLength, 100, true),\n      border: BaseXform.toBoolAttribute(model.border, false),\n      gradient: BaseXform.toBoolAttribute(model.gradient, true),\n      negativeBarColorSameAsPositive: BaseXform.toBoolAttribute(model.negativeBarColorSameAsPositive, true),\n      negativeBarBorderColorSameAsPositive: BaseXform.toBoolAttribute(model.negativeBarBorderColorSameAsPositive, true),\n      axisPosition: BaseXform.toAttribute(model.axisPosition, 'auto'),\n      direction: BaseXform.toAttribute(model.direction, 'leftToRight'),\n    });\n\n    model.cfvo.forEach(cfvo => {\n      this.cfvoXform.render(xmlStream, cfvo);\n    });\n\n    this.borderColorXform.render(xmlStream, model.borderColor);\n    this.negativeBorderColorXform.render(xmlStream, model.negativeBorderColor);\n    this.negativeFillColorXform.render(xmlStream, model.negativeFillColor);\n    this.axisColorXform.render(xmlStream, model.axisColor);\n\n    xmlStream.closeNode();\n  }\n\n  createNewModel({attributes}) {\n    return {\n      cfvo: [],\n      minLength: BaseXform.toIntValue(attributes.minLength, 0),\n      maxLength: BaseXform.toIntValue(attributes.maxLength, 100),\n      border: BaseXform.toBoolValue(attributes.border, false),\n      gradient: BaseXform.toBoolValue(attributes.gradient, true),\n      negativeBarColorSameAsPositive: BaseXform.toBoolValue(attributes.negativeBarColorSameAsPositive, true),\n      negativeBarBorderColorSameAsPositive: BaseXform.toBoolValue(attributes.negativeBarBorderColorSameAsPositive, true),\n      axisPosition: BaseXform.toStringValue(attributes.axisPosition, 'auto'),\n      direction: BaseXform.toStringValue(attributes.direction, 'leftToRight'),\n    };\n  }\n\n  onParserClose(name, parser) {\n    const [,prop] = name.split(':');\n    switch (prop) {\n      case 'cfvo':\n        this.model.cfvo.push(parser.model);\n        break;\n\n      default:\n        this.model[prop] = parser.model;\n        break;\n    }\n  }\n}\n\nmodule.exports = DatabarExtXform;\n"],"mappings":"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"}